<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Reference</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>Pinnacle</h1>


<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/defs.html">defs</a></li>
  <li><a href="../modules/Input.html">Input</a></li>
  <li><a href="../modules/Builtin.html">Builtin</a></li>
  <li><a href="../modules/Builtin.html">Builtin</a></li>
  <li><a href="../modules/Builtin.html">Builtin</a></li>
  <li><a href="../modules/Builtin.html">Builtin</a></li>
  <li><a href="../modules/Builtin.html">Builtin</a></li>
  <li><a href="../modules/Builtin.html">Builtin</a></li>
  <li><a href="../modules/Layout.html">Layout</a></li>
  <li><strong>Output</strong></li>
  <li><a href="../modules/Pinnacle.html">Pinnacle</a></li>
  <li><a href="../modules/Process.html">Process</a></li>
  <li><a href="../modules/Render.html">Render</a></li>
  <li><a href="../modules/Tag.html">Tag</a></li>
  <li><a href="../modules/RectangleModule.html">RectangleModule</a></li>
  <li><a href="../modules/Util.html">Util</a></li>
  <li><a href="../modules/Window.html">Window</a></li>
</ul>
<h2>Classes</h2>
<ul class="nowrap">
  <li><a href="../classes/CyclingLayoutManager.html">CyclingLayoutManager</a></li>
  <li><a href="../classes/OutputHandle.html">OutputHandle</a></li>
  <li><a href="../classes/SignalHandle.html">SignalHandle</a></li>
  <li><a href="../classes/SignalHandles.html">SignalHandles</a></li>
  <li><a href="../classes/TagHandle.html">TagHandle</a></li>
  <li><a href="../classes/Rectangle.html">Rectangle</a></li>
  <li><a href="../classes/WindowHandle.html">WindowHandle</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>Output</code></h1>
<p>Output management.</p>
<p>An output is what you would call a monitor. It presents windows, your cursor, and other UI elements.</p>

<p>Outputs are uniquely identified by their name, a.k.a. the name of the connector they're plugged in to.</p>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#output.get_all">output.get_all()</a></td>
	<td class="summary">Get all outputs.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#output.get_by_name">output.get_by_name(name)</a></td>
	<td class="summary">Get an output by its name (the connector it's plugged into).</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#output.get_focused">output.get_focused()</a></td>
	<td class="summary">Get the currently focused output.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#output.connect_for_all">output.connect_for_all(callback)</a></td>
	<td class="summary">Connect a function to be run with all current and future outputs.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#output.setup">output.setup(setups)</a></td>
	<td class="summary">Declaratively setup outputs.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#output.setup_locs">output.setup_locs(update_locs_on, locs)</a></td>
	<td class="summary">Setup locations for outputs.</td>
	</tr>
	<tr>
	<td class="name" nowrap><a href="#output.connect_signal">output.connect_signal(signals)</a></td>
	<td class="summary">Connect to an output signal.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "output.get_all"></a>
    <strong>output.get_all()</strong>
    </dt>
    <dd>
    Get all outputs.



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../classes/OutputHandle.html#">OutputHandle[]</a></span>



    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> outputs = Output.<span class="function-name">get_all</span>()</pre>
    </ul>

</dd>
    <dt>
    <a name = "output.get_by_name"></a>
    <strong>output.get_by_name(name)</strong>
    </dt>
    <dd>
    Get an output by its name (the connector it's plugged into).


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">name</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.4/manual.html#6.4">string</a></span>
         The name of the connector the output is connected to
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../classes/OutputHandle.html#">OutputHandle</a> or <span class="type">nil</span></span>



    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> output = Output.<span class="function-name">get_by_name</span>(<span class="string">"eDP-1"</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "output.get_focused"></a>
    <strong>output.get_focused()</strong>
    </dt>
    <dd>
    Get the currently focused output. </p>

<p>This is currently defined as the most recent one that has had pointer motion.



    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../classes/OutputHandle.html#">OutputHandle</a> or <span class="type">nil</span></span>



    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> output = Output.<span class="function-name">get_focused</span>()</pre>
    </ul>

</dd>
    <dt>
    <a name = "output.connect_for_all"></a>
    <strong>output.connect_for_all(callback)</strong>
    </dt>
    <dd>
    Connect a function to be run with all current and future outputs. </p>

<p>This method does two things:
1. Immediately runs <code>callback</code> with all currently connected outputs.
2. Calls <code>callback</code> whenever a new output is plugged in.</p>

<p>This will <em>not</em> run <code>callback</code> with an output that has been unplugged and replugged
to prevent duplicate setup. Instead, the compositor keeps track of the tags and other
state associated with that output and restores it when replugged.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">callback</span>
            <span class="types"><span class="type">function</span></span>



        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example"> <span class="comment">-- Add tags "1" through "5" to all outputs
</span>Output.<span class="function-name">connect_for_all</span>(<span class="keyword">function</span>(output)
    <span class="keyword">local</span> tags = Tag.<span class="function-name">add</span>(output, <span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>, <span class="string">"5"</span>)
    tags[<span class="number">1</span>]:<span class="function-name">toggle_active</span>()
<span class="keyword">end</span>)</pre>
    </ul>

</dd>
    <dt>
    <a name = "output.setup"></a>
    <strong>output.setup(setups)</strong>
    </dt>
    <dd>
    Declaratively setup outputs. </p>

<p><a href="../modules/Output.html#output.setup">Output.setup</a> allows you to specify output properties that will be applied immediately and
on output connection. These include mode, scale, tags, and more.</p>

<p><code>setups</code> is a table of output identifier strings to <code>OutputSetup</code>s.</p>

<h3>Keys</h3>

<p>Keys attempt to match outputs.</p>

<p>Wildcard keys (<code>&quot;*&quot;</code>) will match all outputs. You can additionally filter these outputs
by setting a <code>filter</code> function in the setup that returns true if it should apply to the output.
(See the example.)</p>

<p>Otherwise, keys will attempt to match the exact name of an output.</p>

<p>Use "serial:<number>" to match outputs by their EDID serial. For example, "serial:143256".
Note that not all displays have EDID serials. Also, serials are not guaranteed to be unique.
If you're unlucky enough to have two displays with the same serial, you'll have to use their names
or filter with wildcards instead.</p>

<h3>Setups</h3>

<p>If an output is matched, the corresponding <code>OutputSetup</code> entry will be applied to it.
Any given <code>tags</code> will be added, and things like <code>transform</code>s, <code>scale</code>s, and <code>mode</code>s will be set.</p>

<h3>Ordering setups</h3>

<p>You may need to specify multiple wildcard matches for different setup applications.
You can't just add another key of <code>&quot;*&quot;</code>, because that would overwrite the old <code>&quot;*&quot;</code>.
In this case, you can order setups by prepending <code>n:</code> to the key, where n is an ordering number.
<code>n</code> should be between <code>1</code> and <code>#setups</code>. Setting higher orders without setting lower ones
will cause entries without orders to fill up lower numbers in an arbitrary order. Setting
orders above <code>#setups</code> may cause their entries to not apply.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">setups</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.4/manual.html#6.6">table<string,OutputSetup></a></span>



        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">Output.<span class="function-name">setup</span>({
    <span class="comment">-- Give all outputs tags 1 through 5
</span>    [<span class="string">"1:*"</span>] = {
        tags = { <span class="string">"1"</span>, <span class="string">"2"</span>, <span class="string">"3"</span>, <span class="string">"4"</span>, <span class="string">"5"</span> },
    },
    <span class="comment">-- Give outputs with a preferred mode of 4K a scale of 2.0
</span>    [<span class="string">"2:*"</span>] = {
        filter = <span class="keyword">function</span>(op)
            <span class="keyword">return</span> op:<span class="function-name">preferred_mode</span>().pixel_height == <span class="number">2160</span>
        <span class="keyword">end</span>,
        scale = <span class="number">2.0</span>,
    },
    <span class="comment">-- Additionally give eDP-1 tags 6 and 7
</span>    [<span class="string">"eDP-1"</span>] = {
        tags = { <span class="string">"6"</span>, <span class="string">"7"</span> },
    },
    <span class="comment">-- Match an output by its EDID serial number
</span>    [<span class="string">"serial:235987"</span>] = { ... }
})</pre>
    </ul>

</dd>
    <dt>
    <a name = "output.setup_locs"></a>
    <strong>output.setup_locs(update_locs_on, locs)</strong>
    </dt>
    <dd>
    Setup locations for outputs. </p>

<p>This function lets you declare positions for outputs, either as a specific point in the global
space or relative to another output.</p>

<h3>Choosing when to recompute output positions</h3>

<p><code>update_locs_on</code> specifies when output positions should be recomputed. It can be <code>&quot;all&quot;</code>, signaling you
want positions to update on all of output connect, disconnect, and resize, or it can be a table
containing <code>&quot;connect&quot;</code>, <code>&quot;disconnect&quot;</code>, and/or <code>&quot;resize&quot;</code>.</p>

<h3>Specifying locations</h3>

<p><code>locs</code> should be a table of output identifiers to locations.</p>

<h4>Output identifiers</h4>

<p>Keys for <code>locs</code> should be output identifiers. These are strings of
the name of the output, for example "eDP-1" or "HDMI-A-1".
Additionally, if you want to match the EDID serial of an output,
prepend the serial with "serial:", for example "serial:174652".
You can find this by doing <code>get-edid | edid-decode</code>.</p>

<h4>Fallback relative-tos</h4>

<p>Sometimes you have an output with a relative location, but the output
it's relative to isn't connected. In this case you can specify an
order that locations will be placed by prepending "n:" to the key.
For example, "4:HDMI-1" will be applied before "5:HDMI-1", allowing
you to specify more than one relative output. The first connected
relative output will be chosen for placement. See the example below.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">update_locs_on</span>
            <span class="types"><span class="type">(UpdateLocsOn)[]</span> or <span class="type">"all"</span></span>



        </li>
        <li><span class="parameter">locs</span>
            <span class="types"><a class="type" href="https://www.lua.org/manual/5.4/manual.html#6.6">table<string,OutputLoc></a></span>



        </li>
    </ul>




    <h3>Usage:</h3>
    <ul>
        <pre class="example">               <span class="comment">-- vvvvv Relayout on output connect, disconnect, and resize
</span>Output.<span class="function-name">setup_locs</span>(<span class="string">"all"</span>, {
    <span class="comment">-- Anchor eDP-1 to (0, 0) so we can place other outputs relative to it
</span>    [<span class="string">"eDP-1"</span>] = { <span class="number">0</span>, <span class="number">0</span> },
    <span class="comment">-- Place HDMI-A-1 below it centered
</span>    [<span class="string">"HDMI-A-1"</span>] = { <span class="string">"eDP-1"</span>, <span class="string">"bottom_align_center"</span> },
    <span class="comment">-- Place HDMI-A-2 below HDMI-A-1.
</span>    [<span class="string">"3:HDMI-A-2"</span>] = { <span class="string">"HDMI-A-1"</span>, <span class="string">"bottom_align_center"</span> },
    <span class="comment">-- Additionally, if HDMI-A-1 isn't connected, fallback to placing it below eDP-1 instead.
</span>    [<span class="string">"4:HDMI-A-2"</span>] = { <span class="string">"eDP-1"</span>, <span class="string">"bottom_align_center"</span> },

    <span class="comment">-- Note that the last two have a number followed by a colon. This dictates the order of application.
</span>    <span class="comment">-- Because Lua tables with string keys don't index by declaration order, this is needed to specify that.
</span>    <span class="comment">-- You can also put a "1:" and "2:" in front of "eDP-1" and "HDMI-A-1" if you want to be explicit
</span>    <span class="comment">-- about their ordering.
</span>    <span class="comment">--
</span>    <span class="comment">-- Just note that orders must be from 1 to the length of the array. Entries without an order
</span>    <span class="comment">-- will be filled in from 1 upwards, taking any open slots. Entries with orders above
</span>    <span class="comment">-- #locs may not be applied.
</span>})

 <span class="comment">-- Only relayout on output connect and resize
</span>Output.<span class="function-name">setup_locs</span>({ <span class="string">"connect"</span>, <span class="string">"resize"</span> }, { ... })

 <span class="comment">-- Use EDID serials for identification.
</span> <span class="comment">-- You can run
</span> <span class="comment">-- require("pinnacle").run(function(Pinnacle)
</span> <span class="comment">--     print(Pinnacle.output.get_focused():serial())
</span> <span class="comment">-- end)
</span> <span class="comment">-- in a Lua repl to find the EDID serial of the focused output.
</span>Output.<span class="function-name">setup_locs</span>(<span class="string">"all"</span> {
    [<span class="string">"serial:139487"</span>] = { ... },
})</pre>
    </ul>

</dd>
    <dt>
    <a name = "output.connect_signal"></a>
    <strong>output.connect_signal(signals)</strong>
    </dt>
    <dd>
    Connect to an output signal. </p>

<p>The compositor sends signals about various events. Use this function to run a callback when
some output signal occurs.</p>

<p>This function returns a table of signal handles with each handle stored at the same key used
to connect to the signal. See <a href="../classes/SignalHandles.html#">SignalHandles</a> for more information.


    <h3>Parameters:</h3>
    <ul>
        <li><span class="parameter">signals</span>
            <span class="types"><span class="type">OutputSignal</span></span>
         The signal you want to connect to
        </li>
    </ul>

    <h3>Returns:</h3>
    <ol>

           <span class="types"><a class="type" href="../classes/SignalHandles.html#">SignalHandles</a></span>
        Handles to every signal you connected to wrapped in a table, with keys being the same as the connected signal.
    </ol>


    <h3>See also:</h3>
    <ul>
         <a href="../classes/SignalHandles.html#signalhandles:disconnect_all">SignalHandles.disconnect_all</a>
    </ul>

    <h3>Usage:</h3>
    <ul>
        <pre class="example">Output.<span class="function-name">connect_signal</span>({
    connect = <span class="keyword">function</span>(output)
        <span class="global">print</span>(<span class="string">"New output connected:"</span>, output.name)
    <span class="keyword">end</span>
})</pre>
    </ul>

</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/lunarmodules/LDoc">LDoc 1.5.0</a></i>
<i style="float:right;">Last updated 2024-04-25 01:02:17 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
